# Rogue Planet v1.0.0 - Production Ready Release

**Status**: Planning
**Target**: First production-ready release
**Dependencies**: v0.4.0 bug fixes must be complete

---

## Overview

Version 1.0.0 is the **production-ready milestone** with the two critical P0 features needed for real-world deployment. After v0.4.0 addresses documentation gaps, broken features, and 301 redirect handling, v1.0 adds the core functionality needed for long-term reliable operation.

---

## Release Criteria

v1.0.0 can be released when:
- [ ] All v0.4.0 bug fixes complete (including 301 redirect handling from P3.2)
- [ ] Both P0 features implemented and tested
- [ ] GitHub repository properly configured
- [ ] Production deployment documentation complete
- [ ] Binary distribution packages available
- [ ] Community announcement ready

---

## P0 Features (Critical for Production)

### 1. Feed Autodiscovery üîç

**Problem**: Users give website URLs (https://blog.example.com/) instead of feed URLs (https://blog.example.com/feed.xml). Browser support for RSS discovery removed in modern Firefox/Chrome.

**Solution**: Parse HTML `<link rel="alternate">` tags to find RSS/Atom/JSON Feed URLs

#### Implementation Plan
- [ ] Create new `pkg/discovery` package
- [ ] Fetch HTML page with same SSRF protections as crawler
- [ ] Parse `<link rel="alternate">` tags with types:
  - `application/rss+xml`
  - `application/atom+xml`
  - `application/feed+json`
- [ ] Handle multiple feeds per site (let user choose)
- [ ] Add `rp discover <url>` command
- [ ] Add `--auto-discover` flag to `rp add-feed`

#### Test Coverage
- [ ] Unit tests for HTML parsing
- [ ] Multiple feed discovery (blog with RSS and Atom)
- [ ] No feeds found (plain HTML page)
- [ ] Malformed HTML
- [ ] SSRF protection (localhost, private IPs)
- [ ] Real-world sites (GitHub, WordPress, Medium)

#### Documentation
- [ ] Update README with `rp discover` command
- [ ] Add examples of website URL usage
- [ ] Document --auto-discover flag

**Estimate**: 2 days
**Priority**: P0 - Critical UX improvement

**Note**: 301 redirect handling is covered in v0.4.0 P3.2 and should be completed before v1.0.0 release.

---

### 2. Intelligent Feed Scheduling üìÖ

**Problem**: All feeds fetched at same interval regardless of update frequency. Wastes resources on slow-updating feeds, misses updates on fast-updating feeds.

**Current State**:
- ‚úÖ Database fields exist: `next_fetch`, `fetch_interval`, `last_updated`
- ‚úÖ Index on `next_fetch` exists
- ‚ùå Fields populated but never consulted
- ‚ùå App always fetches ALL active feeds

**Solution**: Adaptive polling based on feed characteristics

#### Implementation Plan

##### Phase 1: Basic Scheduling
- [ ] Add `GetFeedsReadyForFetch(now)` - query `WHERE next_fetch <= ?`
- [ ] Update `next_fetch = now + fetch_interval` after each fetch
- [ ] Start with static intervals (default: 1 hour)
- [ ] Don't fetch feeds not yet due

##### Phase 2: Adaptive Intervals
- [ ] Track `last_updated` (when feed content actually changed)
- [ ] Calculate average update frequency over last 10 fetches
- [ ] Adjust `fetch_interval` based on historical frequency:
  - Never updated: 24 hours
  - Daily updates: 4 hours
  - Multiple times/day: 1 hour
  - Hourly updates: 30 minutes
- [ ] Min interval: 15 minutes (respect server load)
- [ ] Max interval: 7 days (check dormant feeds weekly)

##### Phase 3: Exponential Backoff
- [ ] Track `fetch_error_count` (already exists)
- [ ] On error, increase interval: 1h ‚Üí 2h ‚Üí 4h ‚Üí 8h ‚Üí 24h
- [ ] On success, reset `fetch_error_count` and interval
- [ ] Cap at 7 days for failing feeds

##### Phase 4: Jitter
- [ ] Add random jitter to prevent thundering herd
- [ ] Jitter: ¬±10% of interval (e.g., 1h ¬± 6min)
- [ ] Prevents all feeds fetching at :00

##### Phase 5: Respect Cache-Control
- [ ] Parse `Cache-Control: max-age` header
- [ ] Use as minimum interval (don't fetch more often)
- [ ] Override config if server says "wait 2 hours"

#### Configuration Options
```ini
[planet]
# Scheduling behavior
min_fetch_interval = 900      # 15 minutes (respect server load)
max_fetch_interval = 604800   # 7 days (check dormant feeds)
default_fetch_interval = 3600 # 1 hour (for new feeds)
adaptive_scheduling = true    # Enable smart intervals
respect_cache_control = true  # Honor server Cache-Control
jitter_percent = 10           # Add ¬±10% randomness
```

#### Test Coverage
- [ ] Unit tests for interval calculation logic
- [ ] Adaptive interval adjustment (fast/slow/dormant feeds)
- [ ] Exponential backoff on errors
- [ ] Jitter prevents thundering herd
- [ ] Cache-Control header respected
- [ ] Integration test: only due feeds fetched
- [ ] Integration test: intervals adjust over time

#### Documentation
- [ ] Document scheduling algorithm in CLAUDE.md
- [ ] Add config options to README
- [ ] Explain in user documentation
- [ ] Add `rp status --show-schedule` command

#### Migration Plan
- [ ] No schema changes needed (fields exist)
- [ ] Initialize `next_fetch = now` for existing feeds
- [ ] Initialize `fetch_interval = 3600` (1 hour)

**Estimate**: 1 week (5 phases)
**Priority**: P0 - Scalability and efficiency

---

## P1: GitHub Repository Setup üèóÔ∏è

These tasks are part of the launch checklist, not code features.

### Repository Configuration
- [ ] **Update repository description**
  "Modern feed aggregator inspired by Planet Venus, written in Go. Supports RSS, Atom, and JSON Feed with intelligent scheduling and XSS prevention."

- [ ] **Add topics/tags**
  `rss`, `atom`, `feed-aggregator`, `planet`, `go`, `golang`, `static-site-generator`, `json-feed`, `self-hosted`

- [ ] **Enable Issues** - For bug reports and feature requests
- [ ] **Enable Discussions** - For support and community
- [ ] **Configure branch protection for `main`**
  - Require PR reviews
  - Require status checks to pass
  - Require branches to be up to date

- [ ] **Verify default branch is `main`**

### Release v1.0.0
- [ ] **Create v1.0.0 release tag**
  `git tag -a v1.0.0 -m "Release v1.0.0 - Production Ready"`

- [ ] **Push tag to GitHub**
  `git push origin v1.0.0`

- [ ] **Create GitHub Release**
  - Title: "Rogue Planet v1.0.0 - Production Ready"
  - Copy release notes from CHANGELOG.md
  - **Mark as stable release** (not pre-release)
  - Upload pre-built binaries (Linux, macOS, Windows)
  - Include SHA256 checksums

- [ ] **Verify README renders correctly** on GitHub

### CI/CD Setup (Optional but Recommended)
- [ ] **GitHub Actions workflow**
  - Run tests on push/PR
  - Multiple Go versions (1.22, 1.23, 1.24)
  - Multiple platforms (Linux, macOS, Windows)

- [ ] **Automated releases**
  - Build binaries for multiple platforms on tag push
  - Attach to GitHub Release automatically

- [ ] **Code coverage reporting**
  - Integrate with codecov.io
  - Post coverage on PRs

- [ ] **Dependabot configuration**
  - Auto-update dependencies
  - Security vulnerability scanning

### Community Announcement
- [ ] **Social Media**
  - Twitter/X
  - Mastodon
  - Reddit (r/golang, r/selfhosted)
  - Hacker News (Show HN)

- [ ] **Submit to Directories**
  - awesome-go list
  - awesome-selfhosted list
  - Go package discovery (pkg.go.dev - auto-indexed)

- [ ] **Write Launch Blog Post**
  - Technical writeup about the project
  - Design decisions (static output, Go, SQLite)
  - Comparison with Planet Venus
  - Security improvements (CVE-2009-2937 prevention)

- [ ] **Create Demo Site**
  - Host example planet on free hosting (GitHub Pages, Netlify)
  - Aggregate Go/tech blogs
  - Show off default theme
  - Link from README

**Estimate**: 1 day
**Priority**: Required for v1.0 launch

**Note**: Atom Torture Test research is covered in v0.4.0 P2.6 and should be completed before v1.0.0 begins.

---

## Documentation Requirements

All features must include:
- [ ] README.md updates with usage examples
- [ ] CLAUDE.md updates for developers
- [ ] CHANGELOG.md entries
- [ ] Test coverage >75%
- [ ] WORKFLOWS.md updates if new commands

---

## Testing Requirements

### Unit Tests
- [ ] Each new feature has dedicated test file
- [ ] Edge cases covered
- [ ] Error paths tested

### Integration Tests
- [ ] End-to-end workflow tests
- [ ] Database migrations tested
- [ ] Command-line interface tested

### Coverage Goals
- [ ] Maintain >75% on all library packages
- [ ] Improve cmd/rp from 26.6% to >50%

### Quality Gates
- [ ] `make check` passes (fmt + vet + test + race)
- [ ] No race conditions detected
- [ ] All security tests passing

---

## Implementation Phases

### Phase 1: Core Features (Week 1)
1. **Day 1-2**: Feed Autodiscovery
   - Create pkg/discovery package
   - Implement HTML parsing
   - Add `rp discover` command

2. **Day 3-5**: Intelligent Scheduling (Phase 1-2)
   - Basic scheduling with static intervals
   - Adaptive interval calculation
   - Database query by next_fetch

### Phase 2: Scheduling & Polish (Week 2)
1. **Day 1-2**: Intelligent Scheduling (Phase 3-5)
   - Exponential backoff
   - Jitter implementation
   - Cache-Control support

2. **Day 3**: Testing & Bug Fixes
   - Integration tests
   - Real-world testing
   - Bug fixes

3. **Day 4**: Documentation
   - Update all docs
   - Write blog post
   - Prepare announcement

4. **Day 5**: GitHub Setup & Release
   - Configure repository
   - Create release
   - Community announcement

---

## Success Metrics

- ‚úÖ Users can add feeds with website URLs (autodiscovery)
- ‚úÖ Feed URLs auto-update on 301 redirects (from v0.4.0)
- ‚úÖ Feeds fetched at appropriate intervals (not all at once)
- ‚úÖ Less bandwidth usage (smart scheduling)
- ‚úÖ Repository has Issues enabled and good README
- ‚úÖ GitHub Release with binaries available
- ‚úÖ Test coverage >75% maintained
- ‚úÖ Zero regressions from v0.4.0

---

## Out of Scope (Deferred to v1.x/v2.0)

These remain on the wishlist but not required for v1.0:
- HTML escaping in titles (P1)
- Auto-reactivate inactive feeds (P1)
- Character encoding detection (P1)
- HTTP authentication (P1)
- data-* attributes (P2)
- Future dates config (P2)
- Enhanced media tags (P2)
- Embedded content handling (P2)
- MathJax support (P3)

---

## Post-Release Tasks

After v1.0.0 is released:
- [ ] Monitor GitHub Issues for bug reports
- [ ] Respond to community feedback
- [ ] Plan v1.1 based on user requests
- [ ] Consider P1 features for v1.x releases

---

## Summary

**Total Estimate**: 2 weeks
- Week 1: Feed autodiscovery (2 days) + Intelligent scheduling Phase 1-2 (3 days)
- Week 2: Intelligent scheduling Phase 3-5 (2 days) + Testing (1 day) + Documentation (1 day) + GitHub setup (1 day)

**Prerequisites**:
- v0.4.0 must be complete (including 301 redirect handling from P3.2)
- All v0.4.0 bug fixes and documentation updates done

**Target Release**: After v0.4.0 is complete
**Status**: Ready to begin after v0.4.0 ships
